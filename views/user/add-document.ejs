<!DOCTYPE html>
<html lang="en">
  <head>
    <%- include('../includes/head') %>
    <link rel="stylesheet" href="/css/forms.css" />
  </head>
  <body>
    <%- include('../includes/navbar') %>
    <main>
      <%- include('../includes/error-feedback') %>
      <form
        class="text-center center-half"
        method="POST"
        action="/add-document"
      >
        <fieldset>
          <legend>Nouveau document</legend>
          <div class="form-group">
            <label for="fileUrl">Fichier</label>
            <input
              type="text"
              class="form-control text-center pointer <%= validationErrors.some(err => err.param === 'fileUrl') ? 'invalid' : '' %>"
              id="fileUrl"
              name="fileUrl"
              value="<%= oldInput.fileUrl %>"
            />
            <small class="form-text text-muted">Format PDF.</small>
          </div>
          <div class="form-group">
            <label for="doctypeId">Type</label>
            <select
              lastChoice="<%= oldInput.doctypeId %>"
              class="form-control text-center pointer <%= validationErrors.some(err => err.param === 'doctypeId') ? 'invalid' : '' %>"
              id="doctypeId"
              name="doctypeId"
            >
              <option value="" disabled selected>
                Sélectionner un type de document ...
              </option>
              <% for (let doctype of doctypes) { %>
              <option value="<%= doctype._id %>"><%= doctype.title %></option>
              <% } %>
            </select>
            <small class="form-text text-muted"
            >Certains documents uniques (ex : Carte d'identité) ne peuvent avoir de doublon par utilisateur.</small
          >
          </div>
          <div class="form-group">
            <label for="title">Titre</label>
            <input
              type="text"
              class="form-control text-center <%= validationErrors.some(err => err.param === 'title') ? 'invalid' : '' %>"
              id="title"
              name="title"
              value="<%= oldInput.title %>"
            />
            <small class="form-text text-muted"
            >Entre 4 et 80 caractères.</small
          >
          </div>
          <div class="form-group">
            <label for="issuanceDate">Date d'émission</label>
            <input
              type="date"
              class="form-control text-center pointer <%= validationErrors.some(err => err.param === 'issuanceDate') ? 'invalid' : '' %>"
              id="issuanceDate"
              name="issuanceDate"
              value="<%= oldInput.issuanceDate %>"
            />
            <small class="form-text text-muted"
            >Dans le passé ou le présent.</small
          >
          </div>
          <div class="form-group">
            <label for="expirationDate">Date d'expiration</label>
            <input
              type="date"
              class="form-control text-center pointer <%= validationErrors.some(err => err.param === 'expirationDate') ? 'invalid' : '' %>"
              id="expirationDate"
              name="expirationDate"
              value="<%= oldInput.expirationDate %>"
            />
            <small class="form-text text-muted"
            >Dans le futur ou le présent.</small
          >
          </div>
          <div class="form-group">
            <label for="month">Mois</label>
            <input
              type="month"
              class="form-control text-center pointer <%= validationErrors.some(err => err.param === 'month') ? 'invalid' : '' %>"
              id="month"
              name="month"
              value="<%= oldInput.month %>"
            />
            <small class="form-text text-muted"
            >Passé ou actuel.</small
          >
          </div>
          <div class="form-group">
            <label for="year">Année</label>
            <input
              type="number"
              class="form-control text-center pointer <%= validationErrors.some(err => err.param === 'year') ? 'invalid' : '' %>"
              id="year"
              name="year"
              value="<%= oldInput.year %>"
            />
            <small class="form-text text-muted"
            >Passée ou actuelle.</small
          >
          </div>
          <button type="submit" class="btn btn-primary">Ajouter !</button>
        </fieldset>
      </form>
    </main>
    <%- include('../includes/scripts') %>
    <script src="/js/forms.js"></script>
  </body>
</html>
