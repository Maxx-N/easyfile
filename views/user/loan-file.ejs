<!DOCTYPE html>
<html lang="en">
<head>
  <%- include('../includes/head') %>
</head>
<body class="no-scroll">
<%- include('../includes/navbar') %>
<link rel="stylesheet" href="/css/loan-file.css">
<main class="text-center">
    <div class="d-flex justify-content-around full-height">
        <div class=" half-flex">
              <div class="h3">Dossier de prêt numéro <%= loanFile._id %></div>
              <p>Utilisateur : <%= loanFile.userId.email %></p>
        </div>
        <div class="full-height half-flex">
            <div id="requestsContainer" class="scrollable">
                <% for (let request of loanFile.requestIds) { %>
                    <div class="request">
                        <% for (let group of makeGroupsOfRequestedDocs(request.requestedDocIds)) { %>
                          <div class="list-group group">
                                <% if (group.length > 1) { %>
                                    <div class="choice">Au choix : </div>
                                <% } %>
                                <% for (let doc of group) { %>
                                    <div 
                                    class="list-group-item user-requested-doc"
                                    requestedDoc="<%= JSON.stringify(doc) %>"
                                    isSelected="false"
                                    >
                                        <span><%= doc.doctypeId.title %></span>
                                        <span><%= doc.title ? ' "' + doc.title + '"' : '' %></span>
                                        <span><%= doc.age ? ' - ' + displayRequestedDocAge(doc) : '' %></span>
                                        <% if (hasUserTheRightDocument(userDocuments, allDoctypes, doc)) { %>
                                            <span class="check-container pointer">
                                                <i class="fas fa-check "></i>
                                            </span>
                                        <% } %>
                                    </div>
                                <% } %>
                            </div>
                        <% } %>
                    </div>
                <% } %>
            </div>
        </div>    
    </div>
</main>
<div id="userDocuments" class="hidden" userDocuments="<%= JSON.stringify(userDocuments) %>"></div>
<div id="allDoctypes" class="hidden" allDoctypes="<%= JSON.stringify(allDoctypes) %>"></div>
<%- include('../includes/scripts') %>
<script src="/js/user-checklist.js"></script>
</body>
</html>
